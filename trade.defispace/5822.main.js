(self.webpackChunkmy_swap=self.webpackChunkmy_swap||[]).push([[5822],{90798:e=>{"use strict";e.exports=JSON.parse('{"name":"@gnosis.pm/safe-apps-sdk","version":"3.0.0","description":"SDK developed to integrate third-party apps with Safe-Multisig app.","main":"dist/src/index.js","typings":"dist/src/index.d.ts","_files":["dist/**/*","README.md"],"keywords":["Gnosis","sdk","apps"],"scripts":{"test":"jest","format-dist":"sed -i \'\' \'s/\\"files\\":/\\"_files\\":/\' dist/package.json","build":"yarn rimraf dist && tsc && yarn format-dist","format":"prettier --write \\"src/**/*.ts\\"","lint":"tslint -p tsconfig.json","prepublishOnly":"yarn build"},"author":"Gnosis (https://gnosis.io)","license":"MIT","dependencies":{},"devDependencies":{"@types/jest":"^26.0.23","@types/node":"^15.3.0","husky":"^6.0.0","lint-staged":"^11.0.0","prettier":"^2.2.1","rimraf":"^3.0.2"},"husky":{"hooks":{"pre-commit":"lint-staged"}},"lint-staged":{"src/**/!(*test).ts":["yarn lint","prettier --write"]},"repository":{"type":"git","url":"git+https://github.com/gnosis/safe-apps-sdk.git"},"bugs":{"url":"https://github.com/gnosis/safe-apps-sdk/issues"},"homepage":"https://github.com/gnosis/safe-apps-sdk#readme"}')},55621:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0});const a=s(36750);t.default=class{constructor(e=null,t=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isValidMessage=({origin:e,data:t,source:s})=>{const r=!t,i=s===window.parent,a=(void 0!==t.version&&parseInt(t.version.split(".")[0]))>=1;let n=!0;return Array.isArray(this.allowedOrigins)&&(n=void 0!==this.allowedOrigins.find((t=>t.test(e)))),!r&&i&&a&&n},this.logIncomingMessage=e=>{console.info(`Safe Apps SDK v1: A message was received from origin ${e.origin}. `,e.data)},this.onParentMessage=e=>{this.isValidMessage(e)&&(this.debugMode&&this.logIncomingMessage(e),this.handleIncomingMessage(e.data))},this.handleIncomingMessage=e=>{const{id:t}=e,s=this.callbacks.get(t);s&&(s(e),this.callbacks.delete(t))},this.send=(e,t)=>{const s=a.MessageFormatter.makeRequest(e,t);if("undefined"==typeof window)throw new Error("Window doesn't exist");return window.parent.postMessage(s,"*"),new Promise((e=>{this.callbacks.set(s.id,(t=>{e(t)}))}))},this.allowedOrigins=e,this.debugMode=t,window.addEventListener("message",this.onParentMessage)}},i(s(92628),t)},36750:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageFormatter=void 0;const r=s(78855),i=s(56036);class a{}t.MessageFormatter=a,a.makeRequest=(e,t)=>({id:r.generateRequestId(),method:e,params:t,env:{sdkVersion:i.getSDKVersion()}}),a.makeResponse=(e,t,s)=>({id:e,success:!0,version:s,data:t}),a.makeErrorResponse=(e,t,s)=>({id:e,success:!1,error:t,version:s})},92628:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.METHODS=void 0,t.METHODS={getEnvInfo:"getEnvInfo",sendTransactions:"sendTransactions",rpcCall:"rpcCall",getSafeInfo:"getSafeInfo"}},78855:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRequestId=void 0;const s=e=>e.toString(16).padStart(2,"0");t.generateRequestId=()=>"undefined"!=typeof window?(e=>{const t=new Uint8Array(5);return window.crypto.getRandomValues(t),Array.from(t,s).join("")})():(new Date).getTime().toString(36)},71068:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RPC_CALLS=void 0,t.RPC_CALLS={eth_call:"eth_call",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt"}},60770:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Eth=void 0;const r=s(71068),i=s(92628),a={defaultBlockParam:(e="latest")=>e,returnFullTxObjectParam:(e=!1)=>e,blockNumberToHex:e=>Number.isInteger(e)?`0x${e.toString(16)}`:e};t.Eth=class{constructor(e){this.communicator=e,this.call=this.buildRequest({call:r.RPC_CALLS.eth_call,formatters:[null,a.defaultBlockParam]}),this.getBalance=this.buildRequest({call:r.RPC_CALLS.eth_getBalance,formatters:[null,a.defaultBlockParam]}),this.getCode=this.buildRequest({call:r.RPC_CALLS.eth_getCode,formatters:[null,a.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:r.RPC_CALLS.eth_getStorageAt,formatters:[null,a.blockNumberToHex,a.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:r.RPC_CALLS.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:r.RPC_CALLS.eth_getBlockByHash,formatters:[null,a.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:r.RPC_CALLS.eth_getBlockByNumber,formatters:[a.blockNumberToHex,a.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:r.RPC_CALLS.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:r.RPC_CALLS.eth_getTransactionReceipt})}buildRequest({call:e,formatters:t}){return async s=>{t&&Array.isArray(s)&&t.forEach(((e,t)=>{e&&(s[t]=e(s[t]))}));const r={call:e,params:s},a=await this.communicator.send(i.METHODS.rpcCall,r);if(!a.success)throw new Error(a.error);return a.data}}}},85822:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSDKVersion=void 0;const n=a(s(15381));t.default=n.default,i(s(15381),t),i(s(87633),t),i(s(92628),t),i(s(36750),t);var o=s(56036);Object.defineProperty(t,"getSDKVersion",{enumerable:!0,get:function(){return o.getSDKVersion}})},15381:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(55621),a=r(s(55621)),n=s(9786),o=s(60770);t.default=class{constructor(e={}){if("undefined"==typeof window)throw new Error("Error initializing the sdk: window is undefined");const{whitelistedDomains:t=null,debug:s=!1}=e;this.communicator=new a.default(t,s),this.eth=new o.Eth(this.communicator),this.txs=new n.TXs(this.communicator),this.bootstrap()}async bootstrap(){const{txServiceUrl:e}=await this.getEnvInfo();this.txs.setTxServiceUrl(e)}async getEnvInfo(){const e=await this.communicator.send(i.METHODS.getEnvInfo,void 0);if(!e.success)throw new Error(e.error);return e.data}async getSafeInfo(){const e=await this.communicator.send(i.METHODS.getSafeInfo,void 0);if(!e.success)throw new Error(e.error);return e.data}}},9786:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TXs=void 0;const r=s(92628);t.TXs=class{constructor(e){this.txServiceUrl=null,this.communicator=e}async getBySafeTxHash(e){if(!this.txServiceUrl)throw new Error("ENV information hasn't been synced yet or there was an error during the process");const t=new AbortController,s={method:"GET",signal:t.signal};setTimeout((()=>t.abort()),1e4);try{const t=await fetch(`${this.txServiceUrl}/transactions/${e}`,s);if(200!==t.status)throw new Error("Failed to get the transaction. Either safeTxHash is incorrect or transaction hasn't been indexed by the service yet");return await t.json()}catch(e){throw e}}async send({txs:e,params:t}){if(!e||!e.length)throw new Error("No transactions were passed");const s={txs:e,params:t},i=await this.communicator.send(r.METHODS.sendTransactions,s);if(!i.success)throw new Error(i.error);return i.data}setTxServiceUrl(e){this.txServiceUrl=e}}},87633:(e,t,s)=>{"use strict";var r,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsChangeMethods=t.TransferMethods=t.Operation=void 0,s(92628),(a=t.Operation||(t.Operation={}))[a.CALL=0]="CALL",a[a.DELEGATE_CALL=1]="DELEGATE_CALL",a[a.CREATE=2]="CREATE",(i=t.TransferMethods||(t.TransferMethods={})).TRANSFER="transfer",i.TRANSFER_FROM="transferFrom",i.SAFE_TRANSFER_FROM="safeTransferFrom",(r=t.SettingsChangeMethods||(t.SettingsChangeMethods={})).SETUP="setup",r.SET_FALLBACK_HANDLER="setFallbackHandler",r.ADD_OWNER_WITH_THRESHOLD="addOwnerWithThreshold",r.REMOVE_OWNER="removeOwner",r.REMOVE_OWNER_WITH_THRESHOLD="removeOwnerWithThreshold",r.SWAP_OWNER="swapOwner",r.CHANGE_THRESHOLD="changeThreshold",r.CHANGE_MASTER_COPY="changeMasterCopy",r.ENABLE_MODULE="enableModule",r.DISABLE_MODULE="disableModule",r.EXEC_TRANSACTION_FROM_MODULE="execTransactionFromModule",r.APPROVE_HASH="approveHash",r.EXEC_TRANSACTION="execTransaction"},56036:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSDKVersion=void 0;const i=r(s(90798));t.getSDKVersion=()=>i.default.version.slice(0,5)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS1zd2FwLy4vbm9kZV9tb2R1bGVzL0Bnbm9zaXMucG0vc2FmZS1hcHBzLXNkay9kaXN0L3NyYy9jb21tdW5pY2F0aW9uL2luZGV4LmpzIiwid2VicGFjazovL215LXN3YXAvLi9ub2RlX21vZHVsZXMvQGdub3Npcy5wbS9zYWZlLWFwcHMtc2RrL2Rpc3Qvc3JjL2NvbW11bmljYXRpb24vbWVzc2FnZUZvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly9teS1zd2FwLy4vbm9kZV9tb2R1bGVzL0Bnbm9zaXMucG0vc2FmZS1hcHBzLXNkay9kaXN0L3NyYy9jb21tdW5pY2F0aW9uL21ldGhvZHMuanMiLCJ3ZWJwYWNrOi8vbXktc3dhcC8uL25vZGVfbW9kdWxlcy9AZ25vc2lzLnBtL3NhZmUtYXBwcy1zZGsvZGlzdC9zcmMvY29tbXVuaWNhdGlvbi91dGlscy5qcyIsIndlYnBhY2s6Ly9teS1zd2FwLy4vbm9kZV9tb2R1bGVzL0Bnbm9zaXMucG0vc2FmZS1hcHBzLXNkay9kaXN0L3NyYy9ldGgvY29uc3RhbnRzLmpzIiwid2VicGFjazovL215LXN3YXAvLi9ub2RlX21vZHVsZXMvQGdub3Npcy5wbS9zYWZlLWFwcHMtc2RrL2Rpc3Qvc3JjL2V0aC9pbmRleC5qcyIsIndlYnBhY2s6Ly9teS1zd2FwLy4vbm9kZV9tb2R1bGVzL0Bnbm9zaXMucG0vc2FmZS1hcHBzLXNkay9kaXN0L3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9teS1zd2FwLy4vbm9kZV9tb2R1bGVzL0Bnbm9zaXMucG0vc2FmZS1hcHBzLXNkay9kaXN0L3NyYy9zZGsuanMiLCJ3ZWJwYWNrOi8vbXktc3dhcC8uL25vZGVfbW9kdWxlcy9AZ25vc2lzLnBtL3NhZmUtYXBwcy1zZGsvZGlzdC9zcmMvdHhzL2luZGV4LmpzIiwid2VicGFjazovL215LXN3YXAvLi9ub2RlX21vZHVsZXMvQGdub3Npcy5wbS9zYWZlLWFwcHMtc2RrL2Rpc3Qvc3JjL3R5cGVzLmpzIiwid2VicGFjazovL215LXN3YXAvLi9ub2RlX21vZHVsZXMvQGdub3Npcy5wbS9zYWZlLWFwcHMtc2RrL2Rpc3Qvc3JjL3V0aWxzLmpzIl0sIm5hbWVzIjpbIl9fY3JlYXRlQmluZGluZyIsInRoaXMiLCJPYmplY3QiLCJjcmVhdGUiLCJvIiwibSIsImsiLCJrMiIsInVuZGVmaW5lZCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIl9fZXhwb3J0U3RhciIsImV4cG9ydHMiLCJwIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwidmFsdWUiLCJtZXNzYWdlRm9ybWF0dGVyXzEiLCJkZWZhdWx0IiwiYWxsb3dlZE9yaWdpbnMiLCJkZWJ1Z01vZGUiLCJjYWxsYmFja3MiLCJNYXAiLCJpc1ZhbGlkTWVzc2FnZSIsIm9yaWdpbiIsImRhdGEiLCJzb3VyY2UiLCJlbXB0eU9yTWFsZm9ybWVkIiwic2VudEZyb21QYXJlbnRFbCIsIndpbmRvdyIsInBhcmVudCIsImFsbG93ZWRTREtWZXJzaW9uIiwidmVyc2lvbiIsInBhcnNlSW50Iiwic3BsaXQiLCJ2YWxpZE9yaWdpbiIsIkFycmF5IiwiaXNBcnJheSIsImZpbmQiLCJyZWdFeHAiLCJ0ZXN0IiwibG9nSW5jb21pbmdNZXNzYWdlIiwibXNnIiwiY29uc29sZSIsImluZm8iLCJvblBhcmVudE1lc3NhZ2UiLCJoYW5kbGVJbmNvbWluZ01lc3NhZ2UiLCJwYXlsb2FkIiwiaWQiLCJjYiIsImRlbGV0ZSIsInNlbmQiLCJtZXRob2QiLCJwYXJhbXMiLCJyZXF1ZXN0IiwiTWVzc2FnZUZvcm1hdHRlciIsIm1ha2VSZXF1ZXN0IiwiRXJyb3IiLCJwb3N0TWVzc2FnZSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0IiwicmVzcG9uc2UiLCJhZGRFdmVudExpc3RlbmVyIiwidXRpbHNfMSIsInV0aWxzXzIiLCJnZW5lcmF0ZVJlcXVlc3RJZCIsImVudiIsInNka1ZlcnNpb24iLCJnZXRTREtWZXJzaW9uIiwibWFrZVJlc3BvbnNlIiwic3VjY2VzcyIsIm1ha2VFcnJvclJlc3BvbnNlIiwiZXJyb3IiLCJNRVRIT0RTIiwiZ2V0RW52SW5mbyIsInNlbmRUcmFuc2FjdGlvbnMiLCJycGNDYWxsIiwiZ2V0U2FmZUluZm8iLCJkZWMyaGV4IiwiZGVjIiwidG9TdHJpbmciLCJwYWRTdGFydCIsImxlbiIsImFyciIsIlVpbnQ4QXJyYXkiLCJjcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJmcm9tIiwiam9pbiIsImdlbmVyYXRlSWQiLCJEYXRlIiwiZ2V0VGltZSIsIlJQQ19DQUxMUyIsImV0aF9jYWxsIiwiZXRoX2dldExvZ3MiLCJldGhfZ2V0QmFsYW5jZSIsImV0aF9nZXRDb2RlIiwiZXRoX2dldEJsb2NrQnlIYXNoIiwiZXRoX2dldEJsb2NrQnlOdW1iZXIiLCJldGhfZ2V0U3RvcmFnZUF0IiwiZXRoX2dldFRyYW5zYWN0aW9uQnlIYXNoIiwiZXRoX2dldFRyYW5zYWN0aW9uUmVjZWlwdCIsIkV0aCIsImNvbnN0YW50c18xIiwibWV0aG9kc18xIiwiaW5wdXRGb3JtYXR0ZXJzIiwiZGVmYXVsdEJsb2NrUGFyYW0iLCJhcmciLCJyZXR1cm5GdWxsVHhPYmplY3RQYXJhbSIsImJsb2NrTnVtYmVyVG9IZXgiLCJOdW1iZXIiLCJpc0ludGVnZXIiLCJjb21tdW5pY2F0b3IiLCJidWlsZFJlcXVlc3QiLCJmb3JtYXR0ZXJzIiwiZ2V0QmFsYW5jZSIsImdldENvZGUiLCJnZXRTdG9yYWdlQXQiLCJnZXRQYXN0TG9ncyIsImdldEJsb2NrQnlIYXNoIiwiZ2V0QmxvY2tCeU51bWJlciIsImdldFRyYW5zYWN0aW9uQnlIYXNoIiwiZ2V0VHJhbnNhY3Rpb25SZWNlaXB0IiwiYXN5bmMiLCJmb3JFYWNoIiwiZm9ybWF0dGVyIiwiaSIsIl9faW1wb3J0RGVmYXVsdCIsIm1vZCIsIl9fZXNNb2R1bGUiLCJzZGtfMSIsImNvbW11bmljYXRpb25fMSIsImNvbW11bmljYXRpb25fMiIsInR4c18xIiwiZXRoXzEiLCJvcHRzIiwid2hpdGVsaXN0ZWREb21haW5zIiwiZGVidWciLCJldGgiLCJ0eHMiLCJUWHMiLCJib290c3RyYXAiLCJ0eFNlcnZpY2VVcmwiLCJzZXRUeFNlcnZpY2VVcmwiLCJzYWZlVHhIYXNoIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsIm9wdGlvbnMiLCJzaWduYWwiLCJzZXRUaW1lb3V0IiwiYWJvcnQiLCJyZXMiLCJmZXRjaCIsInN0YXR1cyIsImpzb24iLCJlcnIiLCJsZW5ndGgiLCJtZXNzYWdlUGF5bG9hZCIsInVybCIsIlNldHRpbmdzQ2hhbmdlTWV0aG9kcyIsIlRyYW5zZmVyTWV0aG9kcyIsIk9wZXJhdGlvbiIsInBhY2thZ2VfanNvbl8xIiwic2xpY2UiXSwibWFwcGluZ3MiOiJrdENBQ0EsSUFBSUEsRUFBbUJDLE1BQVFBLEtBQUtELGtCQUFxQkUsT0FBT0MsT0FBUyxTQUFVQyxFQUFHQyxFQUFHQyxFQUFHQyxRQUM3RUMsSUFBUEQsSUFBa0JBLEVBQUtELEdBQzNCSixPQUFPTyxlQUFlTCxFQUFHRyxFQUFJLENBQUVHLFlBQVksRUFBTUMsSUFBSyxXQUFhLE9BQU9OLEVBQUVDLE9BQzNFLFNBQVVGLEVBQUdDLEVBQUdDLEVBQUdDLFFBQ1RDLElBQVBELElBQWtCQSxFQUFLRCxHQUMzQkYsRUFBRUcsR0FBTUYsRUFBRUMsS0FFVk0sRUFBZ0JYLE1BQVFBLEtBQUtXLGNBQWlCLFNBQVNQLEVBQUdRLEdBQzFELElBQUssSUFBSUMsS0FBS1QsRUFBYSxZQUFOUyxHQUFvQlosT0FBT2EsVUFBVUMsZUFBZUMsS0FBS0osRUFBU0MsSUFBSWQsRUFBZ0JhLEVBQVNSLEVBQUdTLElBRTNIWixPQUFPTyxlQUFlSSxFQUFTLGFBQWMsQ0FBRUssT0FBTyxJQUN0RCxNQUFNQyxFQUFxQixFQUFRLE9BbURuQ04sRUFBUU8sUUFsRFIsTUFDSSxZQUFZQyxFQUFpQixLQUFNQyxHQUFZLEdBQzNDckIsS0FBS29CLGVBQWlCLEtBQ3RCcEIsS0FBS3NCLFVBQVksSUFBSUMsSUFDckJ2QixLQUFLcUIsV0FBWSxFQUNqQnJCLEtBQUt3QixlQUFpQixFQUFHQyxT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bUNDL0JoRCxJQUFJaEMsRUFBbUJqSSxNQUFRQSxLQUFLaUksaUJBQW9CLFNBQVVDLEdBQzlELE9BQVFBLEdBQU9BLEVBQUlDLFdBQWNELEVBQU0sQ0FBRSxRQUFXQSxJQUV4RGpJLE9BQU9PLGVBQWVJLEVBQVMsYUFBYyxDQUFFSyxPQUFPLElBQ3RETCxFQUFRMEQsbUJBQWdCLEVBQ3hCLE1BQU04RixFQUFpQm5DLEVBQWdCLEVBQVEsUUFJL0NySCxFQUFRMEQsY0FEYyxJQUFNOEYsRUFBZWpKLFFBQVFjLFFBQVFvSSxNQUFNLEVBQUciLCJmaWxlIjoiNTgyMi5tYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fZXhwb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19leHBvcnRTdGFyKSB8fCBmdW5jdGlvbihtLCBleHBvcnRzKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChleHBvcnRzLCBwKSkgX19jcmVhdGVCaW5kaW5nKGV4cG9ydHMsIG0sIHApO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IG1lc3NhZ2VGb3JtYXR0ZXJfMSA9IHJlcXVpcmUoXCIuL21lc3NhZ2VGb3JtYXR0ZXJcIik7XG5jbGFzcyBQb3N0TWVzc2FnZUNvbW11bmljYXRvciB7XG4gICAgY29uc3RydWN0b3IoYWxsb3dlZE9yaWdpbnMgPSBudWxsLCBkZWJ1Z01vZGUgPSBmYWxzZSkge1xuICAgICAgICB0aGlzLmFsbG93ZWRPcmlnaW5zID0gbnVsbDtcbiAgICAgICAgdGhpcy5jYWxsYmFja3MgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZGVidWdNb2RlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNWYWxpZE1lc3NhZ2UgPSAoeyBvcmlnaW4sIGRhdGEsIHNvdXJjZSB9KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbXB0eU9yTWFsZm9ybWVkID0gIWRhdGE7XG4gICAgICAgICAgICBjb25zdCBzZW50RnJvbVBhcmVudEVsID0gc291cmNlID09PSB3aW5kb3cucGFyZW50O1xuICAgICAgICAgICAgY29uc3QgbWFqb3JWZXJzaW9uTnVtYmVyID0gdHlwZW9mIGRhdGEudmVyc2lvbiAhPT0gJ3VuZGVmaW5lZCcgJiYgcGFyc2VJbnQoZGF0YS52ZXJzaW9uLnNwbGl0KCcuJylbMF0pO1xuICAgICAgICAgICAgY29uc3QgYWxsb3dlZFNES1ZlcnNpb24gPSBtYWpvclZlcnNpb25OdW1iZXIgPj0gMTtcbiAgICAgICAgICAgIGxldCB2YWxpZE9yaWdpbiA9IHRydWU7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0aGlzLmFsbG93ZWRPcmlnaW5zKSkge1xuICAgICAgICAgICAgICAgIHZhbGlkT3JpZ2luID0gdGhpcy5hbGxvd2VkT3JpZ2lucy5maW5kKChyZWdFeHApID0+IHJlZ0V4cC50ZXN0KG9yaWdpbikpICE9PSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gIWVtcHR5T3JNYWxmb3JtZWQgJiYgc2VudEZyb21QYXJlbnRFbCAmJiBhbGxvd2VkU0RLVmVyc2lvbiAmJiB2YWxpZE9yaWdpbjtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2dJbmNvbWluZ01lc3NhZ2UgPSAobXNnKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmluZm8oYFNhZmUgQXBwcyBTREsgdjE6IEEgbWVzc2FnZSB3YXMgcmVjZWl2ZWQgZnJvbSBvcmlnaW4gJHttc2cub3JpZ2lufS4gYCwgbXNnLmRhdGEpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uUGFyZW50TWVzc2FnZSA9IChtc2cpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVmFsaWRNZXNzYWdlKG1zZykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlYnVnTW9kZSAmJiB0aGlzLmxvZ0luY29taW5nTWVzc2FnZShtc2cpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlSW5jb21pbmdNZXNzYWdlKG1zZy5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVJbmNvbWluZ01lc3NhZ2UgPSAocGF5bG9hZCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBpZCB9ID0gcGF5bG9hZDtcbiAgICAgICAgICAgIGNvbnN0IGNiID0gdGhpcy5jYWxsYmFja3MuZ2V0KGlkKTtcbiAgICAgICAgICAgIGlmIChjYikge1xuICAgICAgICAgICAgICAgIGNiKHBheWxvYWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2VuZCA9IChtZXRob2QsIHBhcmFtcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IG1lc3NhZ2VGb3JtYXR0ZXJfMS5NZXNzYWdlRm9ybWF0dGVyLm1ha2VSZXF1ZXN0KG1ldGhvZCwgcGFyYW1zKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIldpbmRvdyBkb2Vzbid0IGV4aXN0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZShyZXF1ZXN0LCAnKicpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja3Muc2V0KHJlcXVlc3QuaWQsIChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmFsbG93ZWRPcmlnaW5zID0gYWxsb3dlZE9yaWdpbnM7XG4gICAgICAgIHRoaXMuZGVidWdNb2RlID0gZGVidWdNb2RlO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMub25QYXJlbnRNZXNzYWdlKTtcbiAgICB9XG59XG5leHBvcnRzLmRlZmF1bHQgPSBQb3N0TWVzc2FnZUNvbW11bmljYXRvcjtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9tZXRob2RzXCIpLCBleHBvcnRzKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5NZXNzYWdlRm9ybWF0dGVyID0gdm9pZCAwO1xuY29uc3QgdXRpbHNfMSA9IHJlcXVpcmUoXCIuL3V0aWxzXCIpO1xuY29uc3QgdXRpbHNfMiA9IHJlcXVpcmUoXCIuLi91dGlsc1wiKTtcbmNsYXNzIE1lc3NhZ2VGb3JtYXR0ZXIge1xufVxuZXhwb3J0cy5NZXNzYWdlRm9ybWF0dGVyID0gTWVzc2FnZUZvcm1hdHRlcjtcbk1lc3NhZ2VGb3JtYXR0ZXIubWFrZVJlcXVlc3QgPSAobWV0aG9kLCBwYXJhbXMpID0+IHtcbiAgICBjb25zdCBpZCA9IHV0aWxzXzEuZ2VuZXJhdGVSZXF1ZXN0SWQoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBpZCxcbiAgICAgICAgbWV0aG9kLFxuICAgICAgICBwYXJhbXMsXG4gICAgICAgIGVudjoge1xuICAgICAgICAgICAgc2RrVmVyc2lvbjogdXRpbHNfMi5nZXRTREtWZXJzaW9uKCksXG4gICAgICAgIH0sXG4gICAgfTtcbn07XG5NZXNzYWdlRm9ybWF0dGVyLm1ha2VSZXNwb25zZSA9IChpZCwgZGF0YSwgdmVyc2lvbikgPT4gKHtcbiAgICBpZCxcbiAgICBzdWNjZXNzOiB0cnVlLFxuICAgIHZlcnNpb24sXG4gICAgZGF0YSxcbn0pO1xuTWVzc2FnZUZvcm1hdHRlci5tYWtlRXJyb3JSZXNwb25zZSA9IChpZCwgZXJyb3IsIHZlcnNpb24pID0+ICh7XG4gICAgaWQsXG4gICAgc3VjY2VzczogZmFsc2UsXG4gICAgZXJyb3IsXG4gICAgdmVyc2lvbixcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVzc2FnZUZvcm1hdHRlci5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuTUVUSE9EUyA9IHZvaWQgMDtcbmV4cG9ydHMuTUVUSE9EUyA9IHtcbiAgICBnZXRFbnZJbmZvOiAnZ2V0RW52SW5mbycsXG4gICAgc2VuZFRyYW5zYWN0aW9uczogJ3NlbmRUcmFuc2FjdGlvbnMnLFxuICAgIHJwY0NhbGw6ICdycGNDYWxsJyxcbiAgICBnZXRTYWZlSW5mbzogJ2dldFNhZmVJbmZvJyxcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZXRob2RzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5nZW5lcmF0ZVJlcXVlc3RJZCA9IHZvaWQgMDtcbi8vIGkuZS4gMC0yNTUgLT4gJzAwJy0nZmYnXG5jb25zdCBkZWMyaGV4ID0gKGRlYykgPT4gZGVjLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpO1xuY29uc3QgZ2VuZXJhdGVJZCA9IChsZW4pID0+IHtcbiAgICBjb25zdCBhcnIgPSBuZXcgVWludDhBcnJheSgobGVuIHx8IDQwKSAvIDIpO1xuICAgIHdpbmRvdy5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycik7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oYXJyLCBkZWMyaGV4KS5qb2luKCcnKTtcbn07XG5jb25zdCBnZW5lcmF0ZVJlcXVlc3RJZCA9ICgpID0+IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIGdlbmVyYXRlSWQoMTApO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCkudG9TdHJpbmcoMzYpO1xufTtcbmV4cG9ydHMuZ2VuZXJhdGVSZXF1ZXN0SWQgPSBnZW5lcmF0ZVJlcXVlc3RJZDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5SUENfQ0FMTFMgPSB2b2lkIDA7XG5leHBvcnRzLlJQQ19DQUxMUyA9IHtcbiAgICBldGhfY2FsbDogJ2V0aF9jYWxsJyxcbiAgICBldGhfZ2V0TG9nczogJ2V0aF9nZXRMb2dzJyxcbiAgICBldGhfZ2V0QmFsYW5jZTogJ2V0aF9nZXRCYWxhbmNlJyxcbiAgICBldGhfZ2V0Q29kZTogJ2V0aF9nZXRDb2RlJyxcbiAgICBldGhfZ2V0QmxvY2tCeUhhc2g6ICdldGhfZ2V0QmxvY2tCeUhhc2gnLFxuICAgIGV0aF9nZXRCbG9ja0J5TnVtYmVyOiAnZXRoX2dldEJsb2NrQnlOdW1iZXInLFxuICAgIGV0aF9nZXRTdG9yYWdlQXQ6ICdldGhfZ2V0U3RvcmFnZUF0JyxcbiAgICBldGhfZ2V0VHJhbnNhY3Rpb25CeUhhc2g6ICdldGhfZ2V0VHJhbnNhY3Rpb25CeUhhc2gnLFxuICAgIGV0aF9nZXRUcmFuc2FjdGlvblJlY2VpcHQ6ICdldGhfZ2V0VHJhbnNhY3Rpb25SZWNlaXB0Jyxcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25zdGFudHMuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkV0aCA9IHZvaWQgMDtcbmNvbnN0IGNvbnN0YW50c18xID0gcmVxdWlyZShcIi4uL2V0aC9jb25zdGFudHNcIik7XG5jb25zdCBtZXRob2RzXzEgPSByZXF1aXJlKFwiLi4vY29tbXVuaWNhdGlvbi9tZXRob2RzXCIpO1xuY29uc3QgaW5wdXRGb3JtYXR0ZXJzID0ge1xuICAgIGRlZmF1bHRCbG9ja1BhcmFtOiAoYXJnID0gJ2xhdGVzdCcpID0+IGFyZyxcbiAgICByZXR1cm5GdWxsVHhPYmplY3RQYXJhbTogKGFyZyA9IGZhbHNlKSA9PiBhcmcsXG4gICAgYmxvY2tOdW1iZXJUb0hleDogKGFyZykgPT4gTnVtYmVyLmlzSW50ZWdlcihhcmcpID8gYDB4JHthcmcudG9TdHJpbmcoMTYpfWAgOiBhcmcsXG59O1xuY2xhc3MgRXRoIHtcbiAgICBjb25zdHJ1Y3Rvcihjb21tdW5pY2F0b3IpIHtcbiAgICAgICAgdGhpcy5jb21tdW5pY2F0b3IgPSBjb21tdW5pY2F0b3I7XG4gICAgICAgIHRoaXMuY2FsbCA9IHRoaXMuYnVpbGRSZXF1ZXN0KHtcbiAgICAgICAgICAgIGNhbGw6IGNvbnN0YW50c18xLlJQQ19DQUxMUy5ldGhfY2FsbCxcbiAgICAgICAgICAgIGZvcm1hdHRlcnM6IFtudWxsLCBpbnB1dEZvcm1hdHRlcnMuZGVmYXVsdEJsb2NrUGFyYW1dLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nZXRCYWxhbmNlID0gdGhpcy5idWlsZFJlcXVlc3Qoe1xuICAgICAgICAgICAgY2FsbDogY29uc3RhbnRzXzEuUlBDX0NBTExTLmV0aF9nZXRCYWxhbmNlLFxuICAgICAgICAgICAgZm9ybWF0dGVyczogW251bGwsIGlucHV0Rm9ybWF0dGVycy5kZWZhdWx0QmxvY2tQYXJhbV0sXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldENvZGUgPSB0aGlzLmJ1aWxkUmVxdWVzdCh7XG4gICAgICAgICAgICBjYWxsOiBjb25zdGFudHNfMS5SUENfQ0FMTFMuZXRoX2dldENvZGUsXG4gICAgICAgICAgICBmb3JtYXR0ZXJzOiBbbnVsbCwgaW5wdXRGb3JtYXR0ZXJzLmRlZmF1bHRCbG9ja1BhcmFtXSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ2V0U3RvcmFnZUF0ID0gdGhpcy5idWlsZFJlcXVlc3Qoe1xuICAgICAgICAgICAgY2FsbDogY29uc3RhbnRzXzEuUlBDX0NBTExTLmV0aF9nZXRTdG9yYWdlQXQsXG4gICAgICAgICAgICBmb3JtYXR0ZXJzOiBbbnVsbCwgaW5wdXRGb3JtYXR0ZXJzLmJsb2NrTnVtYmVyVG9IZXgsIGlucHV0Rm9ybWF0dGVycy5kZWZhdWx0QmxvY2tQYXJhbV0sXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldFBhc3RMb2dzID0gdGhpcy5idWlsZFJlcXVlc3Qoe1xuICAgICAgICAgICAgY2FsbDogY29uc3RhbnRzXzEuUlBDX0NBTExTLmV0aF9nZXRMb2dzLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nZXRCbG9ja0J5SGFzaCA9IHRoaXMuYnVpbGRSZXF1ZXN0KHtcbiAgICAgICAgICAgIGNhbGw6IGNvbnN0YW50c18xLlJQQ19DQUxMUy5ldGhfZ2V0QmxvY2tCeUhhc2gsXG4gICAgICAgICAgICBmb3JtYXR0ZXJzOiBbbnVsbCwgaW5wdXRGb3JtYXR0ZXJzLnJldHVybkZ1bGxUeE9iamVjdFBhcmFtXSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ2V0QmxvY2tCeU51bWJlciA9IHRoaXMuYnVpbGRSZXF1ZXN0KHtcbiAgICAgICAgICAgIGNhbGw6IGNvbnN0YW50c18xLlJQQ19DQUxMUy5ldGhfZ2V0QmxvY2tCeU51bWJlcixcbiAgICAgICAgICAgIGZvcm1hdHRlcnM6IFtpbnB1dEZvcm1hdHRlcnMuYmxvY2tOdW1iZXJUb0hleCwgaW5wdXRGb3JtYXR0ZXJzLnJldHVybkZ1bGxUeE9iamVjdFBhcmFtXSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ2V0VHJhbnNhY3Rpb25CeUhhc2ggPSB0aGlzLmJ1aWxkUmVxdWVzdCh7XG4gICAgICAgICAgICBjYWxsOiBjb25zdGFudHNfMS5SUENfQ0FMTFMuZXRoX2dldFRyYW5zYWN0aW9uQnlIYXNoLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nZXRUcmFuc2FjdGlvblJlY2VpcHQgPSB0aGlzLmJ1aWxkUmVxdWVzdCh7XG4gICAgICAgICAgICBjYWxsOiBjb25zdGFudHNfMS5SUENfQ0FMTFMuZXRoX2dldFRyYW5zYWN0aW9uUmVjZWlwdCxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGJ1aWxkUmVxdWVzdCh7IGNhbGwsIGZvcm1hdHRlcnMgfSkge1xuICAgICAgICByZXR1cm4gYXN5bmMgKHBhcmFtcykgPT4ge1xuICAgICAgICAgICAgaWYgKGZvcm1hdHRlcnMgJiYgQXJyYXkuaXNBcnJheShwYXJhbXMpKSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0dGVycy5mb3JFYWNoKChmb3JtYXR0ZXIsIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdHRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zW2ldID0gZm9ybWF0dGVyKHBhcmFtc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgICAgICAgICAgY2FsbCxcbiAgICAgICAgICAgICAgICBwYXJhbXMsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNvbW11bmljYXRvci5zZW5kKG1ldGhvZHNfMS5NRVRIT0RTLnJwY0NhbGwsIHBheWxvYWQpO1xuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3BvbnNlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgICB9O1xuICAgIH1cbn1cbmV4cG9ydHMuRXRoID0gRXRoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fZXhwb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19leHBvcnRTdGFyKSB8fCBmdW5jdGlvbihtLCBleHBvcnRzKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChleHBvcnRzLCBwKSkgX19jcmVhdGVCaW5kaW5nKGV4cG9ydHMsIG0sIHApO1xufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuZ2V0U0RLVmVyc2lvbiA9IHZvaWQgMDtcbmNvbnN0IHNka18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuL3Nka1wiKSk7XG5leHBvcnRzLmRlZmF1bHQgPSBzZGtfMS5kZWZhdWx0O1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL3Nka1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vdHlwZXNcIiksIGV4cG9ydHMpO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2NvbW11bmljYXRpb24vbWV0aG9kc1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vY29tbXVuaWNhdGlvbi9tZXNzYWdlRm9ybWF0dGVyXCIpLCBleHBvcnRzKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJnZXRTREtWZXJzaW9uXCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB1dGlsc18xLmdldFNES1ZlcnNpb247IH0gfSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IGNvbW11bmljYXRpb25fMSA9IHJlcXVpcmUoXCIuL2NvbW11bmljYXRpb25cIik7XG5jb25zdCBjb21tdW5pY2F0aW9uXzIgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vY29tbXVuaWNhdGlvblwiKSk7XG5jb25zdCB0eHNfMSA9IHJlcXVpcmUoXCIuL3R4c1wiKTtcbmNvbnN0IGV0aF8xID0gcmVxdWlyZShcIi4vZXRoXCIpO1xuY2xhc3MgU2FmZUFwcHNTREsge1xuICAgIGNvbnN0cnVjdG9yKG9wdHMgPSB7fSkge1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRXJyb3IgaW5pdGlhbGl6aW5nIHRoZSBzZGs6IHdpbmRvdyBpcyB1bmRlZmluZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IHdoaXRlbGlzdGVkRG9tYWlucyA9IG51bGwsIGRlYnVnID0gZmFsc2UgfSA9IG9wdHM7XG4gICAgICAgIHRoaXMuY29tbXVuaWNhdG9yID0gbmV3IGNvbW11bmljYXRpb25fMi5kZWZhdWx0KHdoaXRlbGlzdGVkRG9tYWlucywgZGVidWcpO1xuICAgICAgICB0aGlzLmV0aCA9IG5ldyBldGhfMS5FdGgodGhpcy5jb21tdW5pY2F0b3IpO1xuICAgICAgICB0aGlzLnR4cyA9IG5ldyB0eHNfMS5UWHModGhpcy5jb21tdW5pY2F0b3IpO1xuICAgICAgICB0aGlzLmJvb3RzdHJhcCgpO1xuICAgIH1cbiAgICBhc3luYyBib290c3RyYXAoKSB7XG4gICAgICAgIGNvbnN0IHsgdHhTZXJ2aWNlVXJsIH0gPSBhd2FpdCB0aGlzLmdldEVudkluZm8oKTtcbiAgICAgICAgdGhpcy50eHMuc2V0VHhTZXJ2aWNlVXJsKHR4U2VydmljZVVybCk7XG4gICAgfVxuICAgIGFzeW5jIGdldEVudkluZm8oKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jb21tdW5pY2F0b3Iuc2VuZChjb21tdW5pY2F0aW9uXzEuTUVUSE9EUy5nZXRFbnZJbmZvLCB1bmRlZmluZWQpO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXNwb25zZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfVxuICAgIGFzeW5jIGdldFNhZmVJbmZvKCkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY29tbXVuaWNhdG9yLnNlbmQoY29tbXVuaWNhdGlvbl8xLk1FVEhPRFMuZ2V0U2FmZUluZm8sIHVuZGVmaW5lZCk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3BvbnNlLmVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9XG59XG5leHBvcnRzLmRlZmF1bHQgPSBTYWZlQXBwc1NESztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNkay5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuVFhzID0gdm9pZCAwO1xuY29uc3QgbWV0aG9kc18xID0gcmVxdWlyZShcIi4uL2NvbW11bmljYXRpb24vbWV0aG9kc1wiKTtcbmNsYXNzIFRYcyB7XG4gICAgY29uc3RydWN0b3IoY29tbXVuaWNhdG9yKSB7XG4gICAgICAgIHRoaXMudHhTZXJ2aWNlVXJsID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb21tdW5pY2F0b3IgPSBjb21tdW5pY2F0b3I7XG4gICAgfVxuICAgIGFzeW5jIGdldEJ5U2FmZVR4SGFzaChzYWZlVHhIYXNoKSB7XG4gICAgICAgIGlmICghdGhpcy50eFNlcnZpY2VVcmwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVOViBpbmZvcm1hdGlvbiBoYXNuJ3QgYmVlbiBzeW5jZWQgeWV0IG9yIHRoZXJlIHdhcyBhbiBlcnJvciBkdXJpbmcgdGhlIHByb2Nlc3NcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxuICAgICAgICB9O1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgMTAwMDApO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7dGhpcy50eFNlcnZpY2VVcmx9L3RyYW5zYWN0aW9ucy8ke3NhZmVUeEhhc2h9YCwgb3B0aW9ucyk7XG4gICAgICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGdldCB0aGUgdHJhbnNhY3Rpb24uIEVpdGhlciBzYWZlVHhIYXNoIGlzIGluY29ycmVjdCBvciB0cmFuc2FjdGlvbiBoYXNuJ3QgYmVlbiBpbmRleGVkIGJ5IHRoZSBzZXJ2aWNlIHlldFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgICAgcmV0dXJuIGpzb247XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIHNlbmQoeyB0eHMsIHBhcmFtcyB9KSB7XG4gICAgICAgIGlmICghdHhzIHx8ICF0eHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHRyYW5zYWN0aW9ucyB3ZXJlIHBhc3NlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VQYXlsb2FkID0ge1xuICAgICAgICAgICAgdHhzLFxuICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY29tbXVuaWNhdG9yLnNlbmQobWV0aG9kc18xLk1FVEhPRFMuc2VuZFRyYW5zYWN0aW9ucywgbWVzc2FnZVBheWxvYWQpO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXNwb25zZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfVxuICAgIHNldFR4U2VydmljZVVybCh1cmwpIHtcbiAgICAgICAgdGhpcy50eFNlcnZpY2VVcmwgPSB1cmw7XG4gICAgfVxufVxuZXhwb3J0cy5UWHMgPSBUWHM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuU2V0dGluZ3NDaGFuZ2VNZXRob2RzID0gZXhwb3J0cy5UcmFuc2Zlck1ldGhvZHMgPSBleHBvcnRzLk9wZXJhdGlvbiA9IHZvaWQgMDtcbmNvbnN0IG1ldGhvZHNfMSA9IHJlcXVpcmUoXCIuL2NvbW11bmljYXRpb24vbWV0aG9kc1wiKTtcbi8vIGNvcHktcGFzdGluZyBhbGwgdGhlIHR5cGVzIGJlbG93IGZyb20gc2FmZS1yZWFjdCBtYWtlcyBtZSB0aGluayB3ZSBtaWdodCB3YW50IHRvIGV4cG9ydCB0aGVtIHRvIGEgcGFja2FnZVxudmFyIE9wZXJhdGlvbjtcbihmdW5jdGlvbiAoT3BlcmF0aW9uKSB7XG4gICAgT3BlcmF0aW9uW09wZXJhdGlvbltcIkNBTExcIl0gPSAwXSA9IFwiQ0FMTFwiO1xuICAgIE9wZXJhdGlvbltPcGVyYXRpb25bXCJERUxFR0FURV9DQUxMXCJdID0gMV0gPSBcIkRFTEVHQVRFX0NBTExcIjtcbiAgICBPcGVyYXRpb25bT3BlcmF0aW9uW1wiQ1JFQVRFXCJdID0gMl0gPSBcIkNSRUFURVwiO1xufSkoT3BlcmF0aW9uID0gZXhwb3J0cy5PcGVyYXRpb24gfHwgKGV4cG9ydHMuT3BlcmF0aW9uID0ge30pKTtcbi8vIHR5cGVzIGNvbWVzIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9nbm9zaXMvc2FmZS1jbGllbnQtZ2F0ZXdheS9ibG9iLzc1MmU3NmI2ZDFkNDc1NzkxZGJkNzkxN2IxNzRiYjQxZDJkOWQ4YmUvc3JjL3V0aWxzLnJzXG52YXIgVHJhbnNmZXJNZXRob2RzO1xuKGZ1bmN0aW9uIChUcmFuc2Zlck1ldGhvZHMpIHtcbiAgICBUcmFuc2Zlck1ldGhvZHNbXCJUUkFOU0ZFUlwiXSA9IFwidHJhbnNmZXJcIjtcbiAgICBUcmFuc2Zlck1ldGhvZHNbXCJUUkFOU0ZFUl9GUk9NXCJdID0gXCJ0cmFuc2ZlckZyb21cIjtcbiAgICBUcmFuc2Zlck1ldGhvZHNbXCJTQUZFX1RSQU5TRkVSX0ZST01cIl0gPSBcInNhZmVUcmFuc2ZlckZyb21cIjtcbn0pKFRyYW5zZmVyTWV0aG9kcyA9IGV4cG9ydHMuVHJhbnNmZXJNZXRob2RzIHx8IChleHBvcnRzLlRyYW5zZmVyTWV0aG9kcyA9IHt9KSk7XG52YXIgU2V0dGluZ3NDaGFuZ2VNZXRob2RzO1xuKGZ1bmN0aW9uIChTZXR0aW5nc0NoYW5nZU1ldGhvZHMpIHtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJTRVRVUFwiXSA9IFwic2V0dXBcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJTRVRfRkFMTEJBQ0tfSEFORExFUlwiXSA9IFwic2V0RmFsbGJhY2tIYW5kbGVyXCI7XG4gICAgU2V0dGluZ3NDaGFuZ2VNZXRob2RzW1wiQUREX09XTkVSX1dJVEhfVEhSRVNIT0xEXCJdID0gXCJhZGRPd25lcldpdGhUaHJlc2hvbGRcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJSRU1PVkVfT1dORVJcIl0gPSBcInJlbW92ZU93bmVyXCI7XG4gICAgU2V0dGluZ3NDaGFuZ2VNZXRob2RzW1wiUkVNT1ZFX09XTkVSX1dJVEhfVEhSRVNIT0xEXCJdID0gXCJyZW1vdmVPd25lcldpdGhUaHJlc2hvbGRcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJTV0FQX09XTkVSXCJdID0gXCJzd2FwT3duZXJcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJDSEFOR0VfVEhSRVNIT0xEXCJdID0gXCJjaGFuZ2VUaHJlc2hvbGRcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJDSEFOR0VfTUFTVEVSX0NPUFlcIl0gPSBcImNoYW5nZU1hc3RlckNvcHlcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJFTkFCTEVfTU9EVUxFXCJdID0gXCJlbmFibGVNb2R1bGVcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJESVNBQkxFX01PRFVMRVwiXSA9IFwiZGlzYWJsZU1vZHVsZVwiO1xuICAgIFNldHRpbmdzQ2hhbmdlTWV0aG9kc1tcIkVYRUNfVFJBTlNBQ1RJT05fRlJPTV9NT0RVTEVcIl0gPSBcImV4ZWNUcmFuc2FjdGlvbkZyb21Nb2R1bGVcIjtcbiAgICBTZXR0aW5nc0NoYW5nZU1ldGhvZHNbXCJBUFBST1ZFX0hBU0hcIl0gPSBcImFwcHJvdmVIYXNoXCI7XG4gICAgU2V0dGluZ3NDaGFuZ2VNZXRob2RzW1wiRVhFQ19UUkFOU0FDVElPTlwiXSA9IFwiZXhlY1RyYW5zYWN0aW9uXCI7XG59KShTZXR0aW5nc0NoYW5nZU1ldGhvZHMgPSBleHBvcnRzLlNldHRpbmdzQ2hhbmdlTWV0aG9kcyB8fCAoZXhwb3J0cy5TZXR0aW5nc0NoYW5nZU1ldGhvZHMgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHlwZXMuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmdldFNES1ZlcnNpb24gPSB2b2lkIDA7XG5jb25zdCBwYWNrYWdlX2pzb25fMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vcGFja2FnZS5qc29uXCIpKTtcbi8vIGNvbnNvbGUubG9nKHsgcGtnIH0pO1xuLy8gU2xpY2UgaXMgbmVlZGVkIGZvciB2ZXJzaW9ucyBsaWtlICcxLjAuMC1iZXRhLjAnXG5jb25zdCBnZXRTREtWZXJzaW9uID0gKCkgPT4gcGFja2FnZV9qc29uXzEuZGVmYXVsdC52ZXJzaW9uLnNsaWNlKDAsIDUpO1xuZXhwb3J0cy5nZXRTREtWZXJzaW9uID0gZ2V0U0RLVmVyc2lvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCJdLCJzb3VyY2VSb290IjoiIn0=